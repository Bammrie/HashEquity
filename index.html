<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>HashEquity - Login</title>
  <style>
    body {
      background: black;
      color: white;
      font-family: Arial, sans-serif;
      text-align: center;
      margin: 0;
      padding: 0;
    }
    h1 { margin-top: 40px; }
    .login-box {
      margin: 30px auto;
      background: #111;
      padding: 20px;
      border-radius: 12px;
      width: 300px;
      box-shadow: 0 0 10px rgba(0,255,0,0.4);
    }
    input {
      margin: 10px;
      padding: 10px;
      width: 90%;
      border-radius: 6px;
      border: none;
    }
    button {
      margin: 10px;
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      background: limegreen;
      color: black;
      font-weight: bold;
      cursor: pointer;
    }
    button:hover {
      background: #32cd32;
    }
    .stats {
      margin: 40px auto;
      width: 90%;
      max-width: 900px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
    }
    th {
      font-size: 1.2em;
      padding: 15px;
      border-bottom: 2px solid limegreen;
    }
    td {
      padding: 20px;
      text-align: center;
    }
    td img {
      width: 50px;
      display: block;
      margin: 0 auto 10px;
    }
    td span {
      font-size: 1.1em;
      font-weight: bold;
      color: #00ffcc;
    }
  </style>
</head>
<body>
  <h1>HashEquity</h1>

  <!-- Auth -->
  <div class="login-box" id="authBox">
    <input type="text" id="email" placeholder="Email"><br>
    <input type="password" id="password" placeholder="Password"><br>
    <button onclick="signup()">Sign Up</button>
    <button onclick="login()">Log In</button>
  </div>

  <!-- Stats -->
  <div class="stats" id="statsBox"></div>

  <script>
    const API_BASE = "https://api.hashequity.com/api";
    let token = localStorage.getItem("token");

    async function signup() {
      const email = document.getElementById("email").value;
      const password = document.getElementById("password").value;
      const res = await fetch(`${API_BASE}/auth/signup`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ email, password })
      });
      const data = await res.json();
      if (res.ok) {
        token = data.token;
        localStorage.setItem("token", token);
        window.location.href = "game.html";
      } else {
        alert(data.error || "Signup failed");
      }
    }

    async function login() {
      const email = document.getElementById("email").value;
      const password = document.getElementById("password").value;
      const res = await fetch(`${API_BASE}/auth/login`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ email, password })
      });
      const data = await res.json();
      if (res.ok) {
        token = data.token;
        localStorage.setItem("token", token);
        window.location.href = "game.html";
      } else {
        alert(data.error || "Login failed");
      }
    }

    // Load global stats in table format
    async function loadStats() {
      const res = await fetch(`${API_BASE}/game/stats`);
      const stats = await res.json();

      const objectData = {
        base: { img: "images/HASH.png", label: "Base" },
        blue: { img: "images/HASHBlue.png", label: "Blue" },
        red: { img: "images/HASHRed.png", label: "Red" },
        gold: { img: "images/HASHGold.png", label: "Gold" },
        rainbow: { img: "images/HASHRainbow.png", label: "Rainbow" }
        // âš¡ If you add more objects, just expand here
      };

      let html = "<h2>Global Destroy Stats</h2><table><tr>";
      for (let key in objectData) {
        html += `<th>${objectData[key].label}</th>`;
      }
      html += "</tr><tr>";
      for (let key in objectData) {
        const stat = stats.find(s => s.objectType === key);
        html += `<td>
          <img src="${objectData[key].img}" alt="${key}">
          <span>${stat ? stat.destroyedCount : 0}</span>
        </td>`;
      }
      html += "</tr></table>";

      document.getElementById("statsBox").innerHTML = html;
    }

    loadStats();
  </script>
</body>
</html>
